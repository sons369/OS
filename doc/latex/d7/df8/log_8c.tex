\hypertarget{log_8c}{}\doxysection{log.\+c 파일 참조}
\label{log_8c}\index{log.c@{log.c}}
{\ttfamily \#include \char`\"{}types.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}defs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}param.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}spinlock.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sleeplock.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}fs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}buf.\+h\char`\"{}}\newline
log.\+c에 대한 include 의존 그래프
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{de/d6f/log_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{데이터 구조}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structlogheader}{logheader}}
\item 
struct \mbox{\hyperlink{structlog}{log}}
\end{DoxyCompactItemize}
\doxysubsection*{함수}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{log_8c_a18cdf83ef674be145df14b83500f1d1b}{recover\+\_\+from\+\_\+log}} (void)
\item 
static void \mbox{\hyperlink{log_8c_a504ac82448623ae8ad27b97dbed82694}{commit}} ()
\item 
void \mbox{\hyperlink{log_8c_ad5e79aaefb91f41b9ef6aeae7ecf4708}{initlog}} (int dev)
\item 
static void \mbox{\hyperlink{log_8c_ab5eaeac1ab988530dcda4fd57a634df0}{install\+\_\+trans}} (void)
\item 
static void \mbox{\hyperlink{log_8c_a608ce9e072cf1640900437d6b59ca181}{read\+\_\+head}} (void)
\item 
static void \mbox{\hyperlink{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}{write\+\_\+head}} (void)
\item 
void \mbox{\hyperlink{log_8c_ac96aa31ffc0500e749c62c4d377c21c9}{begin\+\_\+op}} (void)
\item 
void \mbox{\hyperlink{log_8c_ac0f12be0ca0de555e60b27b06a57a65b}{end\+\_\+op}} (void)
\item 
static void \mbox{\hyperlink{log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1}{write\+\_\+log}} (void)
\item 
void \mbox{\hyperlink{log_8c_a7eacb0fbebe5ce4c7d3ddea15908b13d}{log\+\_\+write}} (struct \mbox{\hyperlink{structbuf}{buf}} $\ast$b)
\end{DoxyCompactItemize}
\doxysubsection*{변수}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structlog}{log}} \mbox{\hyperlink{log_8c_a3583f58fafd1ed3c2dba9d6dfc67c597}{log}}
\end{DoxyCompactItemize}


\doxysubsection{함수 문서화}
\mbox{\Hypertarget{log_8c_ac96aa31ffc0500e749c62c4d377c21c9}\label{log_8c_ac96aa31ffc0500e749c62c4d377c21c9}} 
\index{log.c@{log.c}!begin\_op@{begin\_op}}
\index{begin\_op@{begin\_op}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{begin\_op()}{begin\_op()}}
{\footnotesize\ttfamily void begin\+\_\+op (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



log.\+c 파일의 126 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{127 \{}
\DoxyCodeLine{128   \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{129   \textcolor{keywordflow}{while}(1)\{}
\DoxyCodeLine{130     \textcolor{keywordflow}{if}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_afc034b98b98897c179ca8fae8e2ee181}{committing}})\{}
\DoxyCodeLine{131       \mbox{\hyperlink{defs_8h_aca4a88f06b3ebbcc04330f7ae06c8507}{sleep}}(\&\mbox{\hyperlink{structlog}{log}}, \&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{132     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} + (\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_addfc1fc09a124978bd7e2a23a19d733d}{outstanding}}+1)*\mbox{\hyperlink{param_8h_a31cde324007b4e52bbba7079ec5e5f45}{MAXOPBLOCKS}} > \mbox{\hyperlink{param_8h_acc7694167c7840a913939a1b90808b4c}{LOGSIZE}})\{}
\DoxyCodeLine{133       \textcolor{comment}{// this op might exhaust log space; wait for commit.}}
\DoxyCodeLine{134       \mbox{\hyperlink{defs_8h_aca4a88f06b3ebbcc04330f7ae06c8507}{sleep}}(\&\mbox{\hyperlink{structlog}{log}}, \&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{135     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{136       \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_addfc1fc09a124978bd7e2a23a19d733d}{outstanding}} += 1;}
\DoxyCodeLine{137       \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{138       \textcolor{keywordflow}{break};}
\DoxyCodeLine{139     \}}
\DoxyCodeLine{140   \}}
\DoxyCodeLine{141 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ac96aa31ffc0500e749c62c4d377c21c9_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ac96aa31ffc0500e749c62c4d377c21c9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_a504ac82448623ae8ad27b97dbed82694}\label{log_8c_a504ac82448623ae8ad27b97dbed82694}} 
\index{log.c@{log.c}!commit@{commit}}
\index{commit@{commit}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{commit()}{commit()}}
{\footnotesize\ttfamily static void commit (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 193 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{194 \{}
\DoxyCodeLine{195   \textcolor{keywordflow}{if} (\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} > 0) \{}
\DoxyCodeLine{196     \mbox{\hyperlink{log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1}{write\_log}}();     \textcolor{comment}{// Write modified blocks from cache to log}}
\DoxyCodeLine{197     \mbox{\hyperlink{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}{write\_head}}();    \textcolor{comment}{// Write header to disk -\/-\/ the real commit}}
\DoxyCodeLine{198     \mbox{\hyperlink{log_8c_ab5eaeac1ab988530dcda4fd57a634df0}{install\_trans}}(); \textcolor{comment}{// Now install writes to home locations}}
\DoxyCodeLine{199     \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} = 0;}
\DoxyCodeLine{200     \mbox{\hyperlink{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}{write\_head}}();    \textcolor{comment}{// Erase the transaction from the log}}
\DoxyCodeLine{201   \}}
\DoxyCodeLine{202 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a504ac82448623ae8ad27b97dbed82694_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a504ac82448623ae8ad27b97dbed82694_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_ac0f12be0ca0de555e60b27b06a57a65b}\label{log_8c_ac0f12be0ca0de555e60b27b06a57a65b}} 
\index{log.c@{log.c}!end\_op@{end\_op}}
\index{end\_op@{end\_op}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{end\_op()}{end\_op()}}
{\footnotesize\ttfamily void end\+\_\+op (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



log.\+c 파일의 146 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{147 \{}
\DoxyCodeLine{148   \textcolor{keywordtype}{int} do\_commit = 0;}
\DoxyCodeLine{149 }
\DoxyCodeLine{150   \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{151   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_addfc1fc09a124978bd7e2a23a19d733d}{outstanding}} -\/= 1;}
\DoxyCodeLine{152   \textcolor{keywordflow}{if}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_afc034b98b98897c179ca8fae8e2ee181}{committing}})}
\DoxyCodeLine{153     \mbox{\hyperlink{console_8c_a95c0aca5d6d7487933984f08b189917a}{panic}}(\textcolor{stringliteral}{"log.committing"});}
\DoxyCodeLine{154   \textcolor{keywordflow}{if}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_addfc1fc09a124978bd7e2a23a19d733d}{outstanding}} == 0)\{}
\DoxyCodeLine{155     do\_commit = 1;}
\DoxyCodeLine{156     \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_afc034b98b98897c179ca8fae8e2ee181}{committing}} = 1;}
\DoxyCodeLine{157   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{158     \textcolor{comment}{// begin\_op() may be waiting for log space,}}
\DoxyCodeLine{159     \textcolor{comment}{// and decrementing log.outstanding has decreased}}
\DoxyCodeLine{160     \textcolor{comment}{// the amount of reserved space.}}
\DoxyCodeLine{161     \mbox{\hyperlink{defs_8h_a245b56417239f499389b2e806bd99254}{wakeup}}(\&\mbox{\hyperlink{structlog}{log}});}
\DoxyCodeLine{162   \}}
\DoxyCodeLine{163   \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{164 }
\DoxyCodeLine{165   \textcolor{keywordflow}{if}(do\_commit)\{}
\DoxyCodeLine{166     \textcolor{comment}{// call commit w/o holding locks, since not allowed}}
\DoxyCodeLine{167     \textcolor{comment}{// to sleep with locks.}}
\DoxyCodeLine{168     \mbox{\hyperlink{log_8c_a504ac82448623ae8ad27b97dbed82694}{commit}}();}
\DoxyCodeLine{169     \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{170     \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_afc034b98b98897c179ca8fae8e2ee181}{committing}} = 0;}
\DoxyCodeLine{171     \mbox{\hyperlink{defs_8h_a245b56417239f499389b2e806bd99254}{wakeup}}(\&\mbox{\hyperlink{structlog}{log}});}
\DoxyCodeLine{172     \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{173   \}}
\DoxyCodeLine{174 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ac0f12be0ca0de555e60b27b06a57a65b_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ac0f12be0ca0de555e60b27b06a57a65b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_ad5e79aaefb91f41b9ef6aeae7ecf4708}\label{log_8c_ad5e79aaefb91f41b9ef6aeae7ecf4708}} 
\index{log.c@{log.c}!initlog@{initlog}}
\index{initlog@{initlog}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{initlog()}{initlog()}}
{\footnotesize\ttfamily void initlog (\begin{DoxyParamCaption}\item[{int}]{dev }\end{DoxyParamCaption})}



log.\+c 파일의 54 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{55 \{}
\DoxyCodeLine{56   \textcolor{keywordflow}{if} (\textcolor{keyword}{sizeof}(\textcolor{keyword}{struct} \mbox{\hyperlink{structlogheader}{logheader}}) >= \mbox{\hyperlink{fs_8h_a403cf3149c084cea115b85c90721039a}{BSIZE}})}
\DoxyCodeLine{57     \mbox{\hyperlink{console_8c_a95c0aca5d6d7487933984f08b189917a}{panic}}(\textcolor{stringliteral}{"initlog: too big logheader"});}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{keyword}{struct }\mbox{\hyperlink{structsuperblock}{superblock}} \mbox{\hyperlink{fs_8c_a0248d0bac625de5a1415f2f8c91f3343}{sb}};}
\DoxyCodeLine{60   \mbox{\hyperlink{defs_8h_ab56d728e6966819a0260c358d3ac3419}{initlock}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}}, \textcolor{stringliteral}{"log"});}
\DoxyCodeLine{61   \mbox{\hyperlink{defs_8h_aff0080b2133027be2e525ca088b40e78}{readsb}}(dev, \&\mbox{\hyperlink{fs_8c_a0248d0bac625de5a1415f2f8c91f3343}{sb}});}
\DoxyCodeLine{62   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a28d847dd722497fa3497b14f68267618}{start}} = \mbox{\hyperlink{fs_8c_a0248d0bac625de5a1415f2f8c91f3343}{sb}}.\mbox{\hyperlink{structsuperblock_a460268b28aced19797e8d7b84aa60ebf}{logstart}};}
\DoxyCodeLine{63   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a2257e716d4b77efd0524286cf5772a41}{size}} = \mbox{\hyperlink{fs_8c_a0248d0bac625de5a1415f2f8c91f3343}{sb}}.\mbox{\hyperlink{structsuperblock_aea92ae872785fd4fb39b903d9157aac5}{nlog}};}
\DoxyCodeLine{64   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}} = dev;}
\DoxyCodeLine{65   \mbox{\hyperlink{log_8c_a18cdf83ef674be145df14b83500f1d1b}{recover\_from\_log}}();}
\DoxyCodeLine{66 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ad5e79aaefb91f41b9ef6aeae7ecf4708_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ad5e79aaefb91f41b9ef6aeae7ecf4708_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_ab5eaeac1ab988530dcda4fd57a634df0}\label{log_8c_ab5eaeac1ab988530dcda4fd57a634df0}} 
\index{log.c@{log.c}!install\_trans@{install\_trans}}
\index{install\_trans@{install\_trans}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{install\_trans()}{install\_trans()}}
{\footnotesize\ttfamily static void install\+\_\+trans (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 70 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{71 \{}
\DoxyCodeLine{72   \textcolor{keywordtype}{int} tail;}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keywordflow}{for} (tail = 0; tail < \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}; tail++) \{}
\DoxyCodeLine{75     \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *lbuf = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a28d847dd722497fa3497b14f68267618}{start}}+tail+1); \textcolor{comment}{// read log block}}
\DoxyCodeLine{76     \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *dbuf = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[tail]); \textcolor{comment}{// read dst}}
\DoxyCodeLine{77     \mbox{\hyperlink{defs_8h_aa9c8577c0e9d233f85892ec2d9bfe212}{memmove}}(dbuf-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}}, lbuf-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}}, \mbox{\hyperlink{fs_8h_a403cf3149c084cea115b85c90721039a}{BSIZE}});  \textcolor{comment}{// copy block to dst}}
\DoxyCodeLine{78     \mbox{\hyperlink{bio_8c_a63c899c13b176ddf80064d32225e1298}{bwrite}}(dbuf);  \textcolor{comment}{// write dst to disk}}
\DoxyCodeLine{79     \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(lbuf);}
\DoxyCodeLine{80     \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(dbuf);}
\DoxyCodeLine{81   \}}
\DoxyCodeLine{82 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ab5eaeac1ab988530dcda4fd57a634df0_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_ab5eaeac1ab988530dcda4fd57a634df0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_a7eacb0fbebe5ce4c7d3ddea15908b13d}\label{log_8c_a7eacb0fbebe5ce4c7d3ddea15908b13d}} 
\index{log.c@{log.c}!log\_write@{log\_write}}
\index{log\_write@{log\_write}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{log\_write()}{log\_write()}}
{\footnotesize\ttfamily void log\+\_\+write (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structbuf}{buf}} $\ast$}]{b }\end{DoxyParamCaption})}



log.\+c 파일의 214 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{215 \{}
\DoxyCodeLine{216   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{217 }
\DoxyCodeLine{218   \textcolor{keywordflow}{if} (\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} >= \mbox{\hyperlink{param_8h_acc7694167c7840a913939a1b90808b4c}{LOGSIZE}} || \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} >= \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a2257e716d4b77efd0524286cf5772a41}{size}} -\/ 1)}
\DoxyCodeLine{219     \mbox{\hyperlink{console_8c_a95c0aca5d6d7487933984f08b189917a}{panic}}(\textcolor{stringliteral}{"too big a transaction"});}
\DoxyCodeLine{220   \textcolor{keywordflow}{if} (\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_addfc1fc09a124978bd7e2a23a19d733d}{outstanding}} < 1)}
\DoxyCodeLine{221     \mbox{\hyperlink{console_8c_a95c0aca5d6d7487933984f08b189917a}{panic}}(\textcolor{stringliteral}{"log\_write outside of trans"});}
\DoxyCodeLine{222 }
\DoxyCodeLine{223   \mbox{\hyperlink{defs_8h_afe4ef8638f1ecb962a6e67fb086ee3b8}{acquire}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{224   \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}; i++) \{}
\DoxyCodeLine{225     \textcolor{keywordflow}{if} (\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i] == b-\/>\mbox{\hyperlink{structbuf_a756b2bcc88008bef7f21d688aa4a7a48}{blockno}})   \textcolor{comment}{// log absorbtion}}
\DoxyCodeLine{226       \textcolor{keywordflow}{break};}
\DoxyCodeLine{227   \}}
\DoxyCodeLine{228   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i] = b-\/>\mbox{\hyperlink{structbuf_a756b2bcc88008bef7f21d688aa4a7a48}{blockno}};}
\DoxyCodeLine{229   \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}})}
\DoxyCodeLine{230     \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}++;}
\DoxyCodeLine{231   b-\/>\mbox{\hyperlink{structbuf_ae7d6b6c34fdeadb38970efd0554aa1a9}{flags}} |= \mbox{\hyperlink{buf_8h_adc32011df267adb9740bcd0abf0f0663}{B\_DIRTY}}; \textcolor{comment}{// prevent eviction}}
\DoxyCodeLine{232   \mbox{\hyperlink{defs_8h_a4f8616948f3dbce65671f666eed1d669}{release}}(\&\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a980a1d1aa9c60af7a82f297f8ab54d2e}{lock}});}
\DoxyCodeLine{233 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a7eacb0fbebe5ce4c7d3ddea15908b13d_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a7eacb0fbebe5ce4c7d3ddea15908b13d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_a608ce9e072cf1640900437d6b59ca181}\label{log_8c_a608ce9e072cf1640900437d6b59ca181}} 
\index{log.c@{log.c}!read\_head@{read\_head}}
\index{read\_head@{read\_head}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{read\_head()}{read\_head()}}
{\footnotesize\ttfamily static void read\+\_\+head (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 86 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{87 \{}
\DoxyCodeLine{88   \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *\mbox{\hyperlink{structbuf}{buf}} = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a28d847dd722497fa3497b14f68267618}{start}});}
\DoxyCodeLine{89   \textcolor{keyword}{struct }\mbox{\hyperlink{structlogheader}{logheader}} *lh = (\textcolor{keyword}{struct }\mbox{\hyperlink{structlogheader}{logheader}} *) (\mbox{\hyperlink{structbuf}{buf}}-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}});}
\DoxyCodeLine{90   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{91   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} = lh-\/>\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}};}
\DoxyCodeLine{92   \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}; i++) \{}
\DoxyCodeLine{93     \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i] = lh-\/>\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i];}
\DoxyCodeLine{94   \}}
\DoxyCodeLine{95   \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(\mbox{\hyperlink{structbuf}{buf}});}
\DoxyCodeLine{96 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a608ce9e072cf1640900437d6b59ca181_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a608ce9e072cf1640900437d6b59ca181_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_a18cdf83ef674be145df14b83500f1d1b}\label{log_8c_a18cdf83ef674be145df14b83500f1d1b}} 
\index{log.c@{log.c}!recover\_from\_log@{recover\_from\_log}}
\index{recover\_from\_log@{recover\_from\_log}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{recover\_from\_log()}{recover\_from\_log()}}
{\footnotesize\ttfamily static void recover\+\_\+from\+\_\+log (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 116 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{117 \{}
\DoxyCodeLine{118   \mbox{\hyperlink{log_8c_a608ce9e072cf1640900437d6b59ca181}{read\_head}}();}
\DoxyCodeLine{119   \mbox{\hyperlink{log_8c_ab5eaeac1ab988530dcda4fd57a634df0}{install\_trans}}(); \textcolor{comment}{// if committed, copy from log to disk}}
\DoxyCodeLine{120   \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} = 0;}
\DoxyCodeLine{121   \mbox{\hyperlink{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}{write\_head}}(); \textcolor{comment}{// clear the log}}
\DoxyCodeLine{122 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a18cdf83ef674be145df14b83500f1d1b_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a18cdf83ef674be145df14b83500f1d1b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}\label{log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5}} 
\index{log.c@{log.c}!write\_head@{write\_head}}
\index{write\_head@{write\_head}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{write\_head()}{write\_head()}}
{\footnotesize\ttfamily static void write\+\_\+head (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 102 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{103 \{}
\DoxyCodeLine{104   \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *\mbox{\hyperlink{structbuf}{buf}} = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a28d847dd722497fa3497b14f68267618}{start}});}
\DoxyCodeLine{105   \textcolor{keyword}{struct }\mbox{\hyperlink{structlogheader}{logheader}} *hb = (\textcolor{keyword}{struct }\mbox{\hyperlink{structlogheader}{logheader}} *) (\mbox{\hyperlink{structbuf}{buf}}-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}});}
\DoxyCodeLine{106   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{107   hb-\/>\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}} = \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}};}
\DoxyCodeLine{108   \textcolor{keywordflow}{for} (i = 0; i < \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}; i++) \{}
\DoxyCodeLine{109     hb-\/>\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i] = \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[i];}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111   \mbox{\hyperlink{bio_8c_a63c899c13b176ddf80064d32225e1298}{bwrite}}(\mbox{\hyperlink{structbuf}{buf}});}
\DoxyCodeLine{112   \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(\mbox{\hyperlink{structbuf}{buf}});}
\DoxyCodeLine{113 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_a34322134c00d3e9ad7fb48a7baa9a4c5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1}\label{log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1}} 
\index{log.c@{log.c}!write\_log@{write\_log}}
\index{write\_log@{write\_log}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{write\_log()}{write\_log()}}
{\footnotesize\ttfamily static void write\+\_\+log (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



log.\+c 파일의 178 번째 라인에서 정의되었습니다.


\begin{DoxyCode}{0}
\DoxyCodeLine{179 \{}
\DoxyCodeLine{180   \textcolor{keywordtype}{int} tail;}
\DoxyCodeLine{181 }
\DoxyCodeLine{182   \textcolor{keywordflow}{for} (tail = 0; tail < \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a50b276b70d44ae77497ef1d71d182875}{n}}; tail++) \{}
\DoxyCodeLine{183     \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *to = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a28d847dd722497fa3497b14f68267618}{start}}+tail+1); \textcolor{comment}{// log block}}
\DoxyCodeLine{184     \textcolor{keyword}{struct }\mbox{\hyperlink{structbuf}{buf}} *from = \mbox{\hyperlink{bio_8c_ae000984516278965dde3d125affd086c}{bread}}(\mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_aebeeb9df7326549fb5d8b7221c9b0aa3}{dev}}, \mbox{\hyperlink{structlog}{log}}.\mbox{\hyperlink{structlog_a7808516ed2f708dcb13912b1e8fc20d9}{lh}}.\mbox{\hyperlink{structlogheader_a020db7fe04c7ce6b8f4aee2092576c2c}{block}}[tail]); \textcolor{comment}{// cache block}}
\DoxyCodeLine{185     \mbox{\hyperlink{defs_8h_aa9c8577c0e9d233f85892ec2d9bfe212}{memmove}}(to-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}}, from-\/>\mbox{\hyperlink{structbuf_ab0ec38784ab94ed35e575cf6d33912d2}{data}}, \mbox{\hyperlink{fs_8h_a403cf3149c084cea115b85c90721039a}{BSIZE}});}
\DoxyCodeLine{186     \mbox{\hyperlink{bio_8c_a63c899c13b176ddf80064d32225e1298}{bwrite}}(to);  \textcolor{comment}{// write the log}}
\DoxyCodeLine{187     \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(from);}
\DoxyCodeLine{188     \mbox{\hyperlink{bio_8c_ab5335aeb503731104314321a78a6d727}{brelse}}(to);}
\DoxyCodeLine{189   \}}
\DoxyCodeLine{190 \}}

\end{DoxyCode}
이 함수 내부에서 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1_cgraph}
\end{center}
\end{figure}
이 함수를 호출하는 함수들에 대한 그래프입니다.\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/df8/log_8c_af4e7fbf2920c27568c9b88d45f0bd5e1_icgraph}
\end{center}
\end{figure}


\doxysubsection{변수 문서화}
\mbox{\Hypertarget{log_8c_a3583f58fafd1ed3c2dba9d6dfc67c597}\label{log_8c_a3583f58fafd1ed3c2dba9d6dfc67c597}} 
\index{log.c@{log.c}!log@{log}}
\index{log@{log}!log.c@{log.c}}
\doxysubsubsection{\texorpdfstring{log}{log}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structlog}{log}} \mbox{\hyperlink{structlog}{log}}}



log.\+c 파일의 48 번째 라인에서 정의되었습니다.

